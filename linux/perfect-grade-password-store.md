---
id: perfect-grade-password-store
aliases: []
tags:
  - Security
  - CLI (pass, gpg)
  - Linux
  - Password
  - OTP, 2FA, MFA
  - How-To
date: 2024-02-10T18:22
title: The Perfect Grade Password Store
---
<!-- 2024-02-10-1822 (February 10, 2024 6:22 PM) -->

# The Perfect Grade Password Store
- **pass** is a password manager that uses GPG and Git for Linux
  - CLI-based (although there are plugins, see below)
  - can be used for scripting
- **NOTE: all passwords live in `~/.password-store`**
  - all passwords are encrypted with GPG
- `gpg-agent` is used for caching the password for a certain duration
  - can be configured to stay authenticated for a few minutes
- entries can be organized in a tree-like structure
  - add `/` for directory grouping
  - e.g. `email/gmail`, `email/github`, etc.

## Setup
- Common uses:
```bash
# initialize password store:
pass init <any-name-or-email> # preferably your email

# add/insert an entry:
pass add <entry> # e.g. pass add email/gmail
pass insert <entry> # e.g. pass insert email/gmail

# to see all entries:
pass # or pass ls 

# to copy the password to clipboard (no output to stdout):
pass -c <entry> # or pass show -c <entry>

# to remove a password entry:
pass rm <entry> 

# to see the password for an entry (outputs to stdout, better to use -c especially in public):
pass <entry> # or pass show <entry>

# to edit an entry in a text editor you want:
pass edit <entry>

# to generate a random password using /dev/urandom (good if you suck at passwords):
pass generate <entry> 15
```

- Use Git for version control (highly recommended, since all are encrypted no need to worry about privacy):
```bash
pass git init
pass git remote add origin <git-remote-repo-url>
pass git push # to push to the remote
```
- **NOTE: `pass` creates a `git commit` (locally) each a password is manipulated (when adding, removing, editing, etc.)**
  - then `pass git push` it to update the remote
- more details on `pass git` [here](https://git.zx2c4.com/password-store/about/#EXTENDED%20GIT%20EXAMPLE)

## Importing keys from another machine
### 1. `git clone` the remote repo to `~/.password-store`:
```bash
git clone <remote-repo-url> ~/.password-store
# check if the remote is added:
pass
pass show <entry> # should error (gpg-related), if not then something is wrong you dead boi
```
### 2. get the public and private keys (generated by `gpg`)that you used to encrypt the passwords 
- **RECOMMENDED:** export keys (on local, where you have the gpg keypair) and use `scp` (on remote, where you want to import the keys)
  - from local: 
  ```bash
  # get public key
  gpg --output ~/exported-keys/public.gpg --armor --export <email>
  # get private key
  gpg --output ~/exported-keys/private.gpg --armor --export-secret-keys <email>
  # OPTIONAL: compress it
  tar czvf exported-keys.tar.gz ~/exported-keys
  ```
  - from remote: 
  ```bash
  # get keys
  scp -r user@local:/path/to/exported-keys.tar.gz ~/imported-keys
  tar xzf ~/imported-keys/exported-keys.tar.gz -C ~/imported-keys
  # IMPORTANT: import the keys to gpg
  gpg --import public.gpg
  gpg --import private.gpg # will prompt for password

  # then in the gpg-shell:
  trust
  5 # ultimate
  y # confirm
  save
  exit # if save did not exit you to the gpg-shell

  # now check if pass if working as expected
  pass
  pass show <entry> # should now work
  ```

<details>
    <summary> OPTION (not recommended): using my script `,encryptshare` or `,encryptshare-tar` (on the local)</summary>
- **NOTE: this script will use `tar` to compress the keys and encrypt them with `gpg` and then provide a download link (using `0x0.st`) - of course all are encrypted.**

- from local:
```bash
# create directory for keys
mkdir ~/exported-keys
# get public key
gpg --output ~/public.gpg --armor --export <email> # use email instead of uid to reference which key you want to use
# get private key
gpg --output ~/private.gpg --armor --export-secret-keys <email> # use email again
,encryptshare-tar ~/exported-keys # or ,encryptshare ~/exported-keys
# it will prompt for password then provide a download link for the remote machine
```
- from remote:
```bash
# if you used ,encryptshare-tar:
# to download (use curl or aria2c):
curl -o <filename>.tar.gz.gpg "https://<download-link>"
# to decrypt/extract (will prompt for password):
gpg -d --output - "<filename>.tar.gz.gpg"| tar xzf - # or just: gpg --decrypt "<filename>.tar.gz.gpg" | tar xz

# if you used ,encryptshare:
# to download (use curl or aria2c):
curl -o <filename>.zip "https://<download-link>"
# to decrypt/extract (will prompt for password):
unzip <filename>.zip

# check if working
pass
pass show <entry> # should now work
```
</details>

## Usecases
1. **For scripting**
  - `pass` can be used for scripting (e.g. to automate password entry for a service)
  - **NOTE: this is not recommended for sensitive passwords**
  - e.g. for `curl`:
  ```bash
  curl -u $(pass <entry>) https://example.com
  ```
2. environment variables
```bash
export GITHUB_TOKEN=$(pass show github/api/token)
```
3. secure cli commands that require API tokens
```bash
# example for aws cli (before using pass)
aws lambda list-functions --region=us-east-1
# will throw credentials error

# now using pass (automatic secure auth)
alias aws="AWS_ACCESS_KEY_ID=$(pass show aws/access-key-id) AWS_SECRET_ACCESS_KEY=$(pass show aws/secret-access-key) aws"
aws lambda list-functions --region=us-east-1
# successful (shows output)
```

## Plugins
- `pass-otp` - for TOTP (Time-based One-Time Password) support
  - see more details [here](./use-pass-for-2FA-MFA-otp-auth.md)
  - `pass otp <entry>` - get TOTP for an entry
  - `pass otp <entry> | xclip -sel clip` - copy TOTP to clipboard
  - `pass otp -c <entry>` - copy TOTP to clipboard
  - `pass otp -c <entry> | xclip -sel clip` - copy TOTP to clipboard

# References
- main docs/website: [passwordstore.org](https://www.passwordstore.org/)
- [dreamsofcode yt vid](https://www.youtube.com/watch?v=FhwsfH2TpFA&pp=ygUTZHJlYW1zIG9mIGNvZGUgcGFzcw%3D%3D)
- [bugswriter hacker guide](https://www.youtube.com/watch?v=QE9Qj_qI6Q4)
